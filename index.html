<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portf√≥lio de Ativos - Frutas Cripto</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #FFD1DC;
            font-family: 'Comic Sans MS', cursive;
        }
    </style>
</head>
<body class="p-4 text-center">
    <div class="container mx-auto bg-white rounded-lg shadow-lg p-6">
        <h1 class="text-4xl font-bold text-pink-600 mb-6">üçé Portf√≥lio de Ativos üçá</h1>

        <div class="grid md:grid-cols-2 gap-6">
            <!-- Ativos Criptogr√°ficos -->
            <div class="bg-yellow-100 p-4 rounded-lg">
                <h2 class="text-2xl font-semibold text-yellow-700 mb-4">üçã Ativos Cripto</h2>
                <div id="cryptoInputs">
                    <div class="mb-4">
                        <label class="block text-blue-800 mb-2">Bitcoin (BTC)</label>
                        <input type="number" id="btcAmount" class="w-full p-2 border rounded" placeholder="Quantidade de Bitcoin">
                    </div>
                    <div class="mb-4">
                        <label class="block text-blue-800 mb-2">Ethereum (ETH)</label>
                        <input type="number" id="ethAmount" class="w-full p-2 border rounded" placeholder="Quantidade de Ethereum">
                    </div>
                    <div class="mb-4">
                        <label class="block text-blue-800 mb-2">BNB</label>
                        <input type="number" id="bnbAmount" class="w-full p-2 border rounded" placeholder="Quantidade de BNB">
                    </div>
                </div>
            </div>

            <!-- Ativos Tradicionais -->
            <div class="bg-green-100 p-4 rounded-lg">
                <h2 class="text-2xl font-semibold text-green-700 mb-4">ü•ù Ativos Tradicionais</h2>
                <div id="traditionalInputs">
                    <div class="mb-4">
                        <label class="block text-pink-800 mb-2">Real (BRL)</label>
                        <input type="number" id="brlAmount" class="w-full p-2 border rounded" placeholder="Quantidade em Reais">
                    </div>
                    <div class="mb-4">
                        <label class="block text-pink-800 mb-2">D√≥lar (USD)</label>
                        <input type="number" id="usdAmount" class="w-full p-2 border rounded" placeholder="Quantidade em D√≥lares">
                    </div>
                </div>
            </div>
        </div>

        <div class="text-center mt-6">
            <button id="fetchRatesButton" class="bg-pink-500 text-white px-6 py-3 rounded-lg hover:bg-pink-600 transition">
                üí± Buscar Cota√ß√µes
            </button>
            <button id="calculateButton" class="bg-blue-500 text-white px-6 py-3 rounded-lg hover:bg-blue-600 transition ml-4">
                üßÆ Calcular Portf√≥lio
            </button>
        </div>

        <div id="currentRates" class="mt-6 bg-pink-200 p-4 rounded-lg">
            <h3 class="text-xl font-semibold text-center mb-4">Cota√ß√µes Atuais</h3>
            <div id="ratesContent" class="grid md:grid-cols-3 gap-4 text-center">
                <!-- Cota√ß√µes ser√£o exibidas aqui -->
            </div>
        </div>

        <div class="mt-6">
            <h3 class="text-2xl font-semibold text-center mb-4">üìä Distribui√ß√£o de Ativos</h3>
            <div class="flex justify-center">
                <canvas id="portfolioChart" width="100" height="100"></canvas>
            </div>
        </div>
    </div>

    <script>
        let cryptoPrices = {};

        // Fun√ß√£o para buscar cota√ß√µes
        async function fetchCryptoPrices() {
            const ratesContent = document.getElementById('ratesContent');
            const cryptos = ['bitcoin', 'ethereum', 'binancecoin'];
            const fiats = ['brl', 'usd'];

            try {
                const response = await fetch(
                    `https://api.coingecko.com/api/v3/simple/price?ids=${cryptos.join(',')}&vs_currencies=${fiats.join(',')}`
                );
                const data = await response.json();
                cryptoPrices = data; // Armazena as cota√ß√µes para c√°lculo

                ratesContent.innerHTML = ''; // Limpa conte√∫do anterior

                cryptos.forEach((crypto) => {
                    const name = crypto === 'bitcoin' ? 'Bitcoin' : 
                                 crypto === 'ethereum' ? 'Ethereum' : 'BNB';
                    ratesContent.innerHTML += `
                        <div class="bg-blue-100 p-3 rounded">
                            <strong>${name}</strong>
                            <p>BRL: R$ ${data[crypto].brl.toLocaleString()}</p>
                            <p>USD: $ ${data[crypto].usd.toLocaleString()}</p>
                        </div>
                    `;
                });
            } catch (error) {
                ratesContent.innerHTML = 'Erro ao buscar cota√ß√µes.';
            }
        }

        // Evento para buscar cota√ß√µes
        document.getElementById('fetchRatesButton').addEventListener('click', fetchCryptoPrices);

        // Fun√ß√£o para calcular e exibir o gr√°fico
        function calculatePortfolio() {
            const btcAmount = parseFloat(document.getElementById('btcAmount').value) || 0;
            const ethAmount = parseFloat(document.getElementById('ethAmount').value) || 0;
            const bnbAmount = parseFloat(document.getElementById('bnbAmount').value) || 0;
            const brlAmount = parseFloat(document.getElementById('brlAmount').value) || 0;
            const usdAmount = parseFloat(document.getElementById('usdAmount').value) || 0;

            // Converte ativos cripto para BRL
            const btcValue = btcAmount * (cryptoPrices.bitcoin?.brl || 0);
            const ethValue = ethAmount * (cryptoPrices.ethereum?.brl || 0);
            const bnbValue = bnbAmount * (cryptoPrices.binancecoin?.brl || 0);
            const totalPortfolio = btcValue + ethValue + bnbValue + brlAmount + usdAmount;

            const ctx = document.getElementById('portfolioChart').getContext('2d');
            if (window.portfolioChart instanceof Chart) {
                window.portfolioChart.destroy();
            }

            window.portfolioChart = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: ['Bitcoin', 'Ethereum', 'BNB', 'Real', 'D√≥lar'],
                    datasets: [{
                        data: [btcValue, ethValue, bnbValue, brlAmount, usdAmount],
                        backgroundColor: ['#FFD700', '#87CEFA', '#32CD32', '#FF69B4', '#4682B4']
                    }]
                },
                options: {
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        title: {
                            display: true,
                            text: `Distribui√ß√£o do Portf√≥lio (Total: R$ ${totalPortfolio.toFixed(2)})`
                        }
                    }
                }
            });
        }

        // Evento para calcular portf√≥lio
        document.getElementById('calculateButton').addEventListener('click', calculatePortfolio);
    </script>
</body>
</html>
